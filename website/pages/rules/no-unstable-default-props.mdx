# no-unstable-default-props

## Rule category

Perf.

## What it does

Prevents usage of referential-type values as default props in object destructuring.

## Why is this bad?

When using object destructuring syntax you can set the default value for a given property if it does not exist. If you set the default value to one of the values that is compared by identity, then each time the destructuring is evaluated, the JS engine will create a new, distinct value in the destructured variable.

This harms performance as it means that React will have to re-evaluate hooks and re-render memoized components more often than necessary.

To fix the violations, the easiest way is to use a referencing variable in module scope instead of using the literal values.

## Examples

### Failing

```tsx twoslash
import React from "react";

interface ExampleProps {
  items: string[];
}

// @error: Do not use referential types as default props
function Example({ items = [] }: ExampleProps) {
  return null;
}
```

```tsx twoslash
import React from "react";

interface ExampleProps {
  items: Record<string, string>;
}

// @error: Do not use referential types as default props
function Example({ items = {} }: ExampleProps) {
  return null;
}
```

```tsx twoslash
import React from "react";

interface ExampleProps {
  onClick: () => void;
}

// @error: Do not use referential types as default props
function Example({ onClick = () => {} }: ExampleProps) {
  return null;
}
```

```tsx twoslash
import React from "react";

interface ExampleProps {
  items: string[];
}

function Example(props: ExampleProps) {
// @error: Do not use referential types as default props
  const { items = [] } = props;
  return null;
}
```

### Passing

```tsx twoslash
import React from "react";

const emptyArray: string[] = [];

interface ExampleProps {
  items: string[];
}

function Example({ items = emptyArray }: ExampleProps) {
  return null;
}
```

```tsx twoslash
import React from "react";

const emptyObject = {};

interface ExampleProps {
  items: Record<string, string>;
}

function Example({ items = emptyObject }: ExampleProps) {
  return null;
}
```

```tsx twoslash
import React from "react";

const noop = () => {};

interface ExampleProps {
  onClick: () => void;
}

function Example({ onClick = noop }: ExampleProps) {
  return null;
}
```

```tsx twoslash
import React from "react";

const emptyArray: string[] = [];

interface ExampleProps {
  items: string[];
}

function Example(props: ExampleProps) {
  const { items = emptyArray } = props;

  return null;
}
```

```tsx twoslash
import React from "react";

interface ExampleProps {
  num: number;
  str: string;
  bool: boolean;
}

// @log: Primitives are all compared by value, so are safe to be inlined
function Example({ num = 3, str = "foo", bool = true }: ExampleProps) {
  return null;
}
```
